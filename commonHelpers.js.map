{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const API_KEY = '34205532-dcd3b12e75460bc879dbf1602';\nexport const BASE_URL = 'https://pixabay.com/api/?';\n\nexport async function fetchCards(str, page) {\n  const SEARCH_PARAMS = {\n    params: {\n      key: API_KEY,\n      q: str,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 15,\n      page,\n    },\n  };\n\n\n  return await axios\n    .get(`${BASE_URL}`, SEARCH_PARAMS)\n    .then(res => res)\n    .catch(error => console.log(error.status));\n}\n","export function getMarkup(data) {\n  return data\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"card-item\">\n  <a href=${largeImageURL}\n    ><img src=${webformatURL} alt=\"${tags}\" height=\"200\"/>\n    <ul class=\"card-info\">\n      <li>\n        Likes\n        <p>${likes}</p>\n      </li>\n      <li>\n        Views\n        <p>${views}</p>\n      </li>\n      <li>\n        Comments\n        <p>${comments}</p>\n      </li>\n      <li>\n        Downloads\n        <p>${downloads}</p>\n      </li>\n    </ul></a\n  >\n</li>`\n    )\n    .join('');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchCards, API_KEY, BASE_URL } from './js/pixabay-api';\n\nimport { getMarkup } from './js/render-function';\n\nconst searchForm = document.querySelector('.form');\nconst imageList = document.querySelector('.image-list');\nconst loader = document.querySelector('.loader');\nconst loadBtn = document.querySelector('.load-btn');\nconst cardStorage = document.querySelector('.cards');\n\nsearchForm.addEventListener('submit', onSearchFormSubmit);\nloadBtn.addEventListener('click', loadBtnClick);\n\nconst instance = new SimpleLightbox('.card-item a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  captionClass: 'caption',\n});\n\nlet page = 1;\nlet totalPages;\nlet searchQuery;\n\nasync function onSearchFormSubmit(e) {\n  e.preventDefault();\n  page = 1;\n  searchQuery = e.currentTarget.elements.search.value.trim();\n  e.currentTarget.elements.search.value = '';\n\n  imageList.innerHTML = '';\n  toggleLoader();\n\n  await await fetchCards(searchQuery, page)\n    .then(res => checkEndColections(res))\n    .then(res => renderCards(res));\n}\n\nasync function loadBtnClick(e) {\n  page += 1;\n  console.log(page);\n\n  e.preventDefault();\n  toggleLoader();\n\n  return await fetchCards(searchQuery, page)\n    .then(res => checkEndColections(res))\n    .then(res => renderCards(res))\n    .catch(error => console.log(error));\n}\n\nasync function checkEndColections({ data }) {\n  console.log(data);\n  totalPages = Math.ceil(data.totalHits / data.hits.length);\n  if (page >= totalPages && data.totalHits) {\n    iziToast.info({\n      position: 'topRight',\n      timeout: 3000,\n      message: \"We're sorry, but you've reached the end of search results.\",\n      color: 'blue',\n    });\n    loadBtn.classList.add('is-hidden');\n  } else {\n    loadBtn.classList.remove('is-hidden');\n  }\n  return data;\n}\n\nfunction renderCards({ hits }) {\n  if (!hits.length) {\n    iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      position: 'topRight',\n    });\n    loader.classList.add('is-hidden');\n    loadBtn.classList.add('is-hidden');\n    return;\n  } else {\n    const markup = getMarkup(hits);\n    imageList.insertAdjacentHTML('beforeend', markup);\n\n    toggleLoader();\n    instance.refresh();\n\n    const { height } = cardStorage.getBoundingClientRect();\n    window.scrollBy({\n      top: height,\n      behavior: 'smooth',\n    });\n  }\n}\n\nfunction toggleLoader() {\n  loader.classList.toggle('is-hidden');\n}\n"],"names":["API_KEY","BASE_URL","fetchCards","str","page","SEARCH_PARAMS","axios","res","error","getMarkup","data","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchForm","imageList","loader","loadBtn","cardStorage","onSearchFormSubmit","loadBtnClick","instance","SimpleLightbox","totalPages","searchQuery","toggleLoader","checkEndColections","renderCards","iziToast","hits","markup","height"],"mappings":"+vBAEO,MAAMA,EAAU,qCACVC,EAAW,4BAEjB,eAAeC,EAAWC,EAAKC,EAAM,CAC1C,MAAMC,EAAgB,CACpB,OAAQ,CACN,IAAKL,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAAC,CACD,CACL,EAGE,OAAO,MAAME,EACV,IAAI,GAAGL,CAAQ,GAAII,CAAa,EAChC,KAAKE,GAAOA,CAAG,EACf,MAAMC,GAAS,QAAQ,IAAIA,EAAM,MAAM,CAAC,CAC7C,CCvBO,SAASC,EAAUC,EAAM,CAC9B,OAAOA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA,YACAL,CAAa;AAAA,gBACTD,CAAY,SAASE,CAAI;AAAA;AAAA;AAAA;AAAA,aAI5BC,CAAK;AAAA;AAAA;AAAA;AAAA,aAILC,CAAK;AAAA;AAAA;AAAA;AAAA,aAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,aAIRC,CAAS;AAAA;AAAA;AAAA;AAAA,MAKjB,EACA,KAAK,EAAE,CACZ,CC1BA,MAAMC,EAAa,SAAS,cAAc,OAAO,EAC3CC,EAAY,SAAS,cAAc,aAAa,EAChDC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAU,SAAS,cAAc,WAAW,EAC5CC,EAAc,SAAS,cAAc,QAAQ,EAEnDJ,EAAW,iBAAiB,SAAUK,CAAkB,EACxDF,EAAQ,iBAAiB,QAASG,CAAY,EAE9C,MAAMC,EAAW,IAAIC,EAAe,eAAgB,CAClD,aAAc,MACd,aAAc,IACd,aAAc,SAChB,CAAC,EAED,IAAItB,EAAO,EACPuB,EACAC,EAEJ,eAAeL,EAAmB,EAAG,CACnC,EAAE,eAAc,EAChBnB,EAAO,EACPwB,EAAc,EAAE,cAAc,SAAS,OAAO,MAAM,OACpD,EAAE,cAAc,SAAS,OAAO,MAAQ,GAExCT,EAAU,UAAY,GACtBU,IAEA,MAAM,MAAM3B,EAAW0B,EAAaxB,CAAI,EACrC,KAAKG,GAAOuB,EAAmBvB,CAAG,CAAC,EACnC,KAAKA,GAAOwB,EAAYxB,CAAG,CAAC,CACjC,CAEA,eAAeiB,EAAa,EAAG,CAC7B,OAAApB,GAAQ,EACR,QAAQ,IAAIA,CAAI,EAEhB,EAAE,eAAc,EAChByB,IAEO,MAAM3B,EAAW0B,EAAaxB,CAAI,EACtC,KAAKG,GAAOuB,EAAmBvB,CAAG,CAAC,EACnC,KAAKA,GAAOwB,EAAYxB,CAAG,CAAC,EAC5B,MAAMC,GAAS,QAAQ,IAAIA,CAAK,CAAC,CACtC,CAEA,eAAesB,EAAmB,CAAE,KAAApB,GAAQ,CAC1C,eAAQ,IAAIA,CAAI,EAChBiB,EAAa,KAAK,KAAKjB,EAAK,UAAYA,EAAK,KAAK,MAAM,EACpDN,GAAQuB,GAAcjB,EAAK,WAC7BsB,EAAS,KAAK,CACZ,SAAU,WACV,QAAS,IACT,QAAS,6DACT,MAAO,MACb,CAAK,EACDX,EAAQ,UAAU,IAAI,WAAW,GAEjCA,EAAQ,UAAU,OAAO,WAAW,EAE/BX,CACT,CAEA,SAASqB,EAAY,CAAE,KAAAE,GAAQ,CAC7B,GAAKA,EAAK,OAUH,CACL,MAAMC,EAASzB,EAAUwB,CAAI,EAC7Bd,EAAU,mBAAmB,YAAae,CAAM,EAEhDL,IACAJ,EAAS,QAAO,EAEhB,KAAM,CAAE,OAAAU,CAAM,EAAKb,EAAY,sBAAqB,EACpD,OAAO,SAAS,CACd,IAAKa,EACL,SAAU,QAChB,CAAK,CACF,KAtBiB,CAChBH,EAAS,MAAM,CACb,MAAO,QACP,QACE,2EACF,SAAU,UAChB,CAAK,EACDZ,EAAO,UAAU,IAAI,WAAW,EAChCC,EAAQ,UAAU,IAAI,WAAW,EACjC,MACJ,CAaA,CAEA,SAASQ,GAAe,CACtBT,EAAO,UAAU,OAAO,WAAW,CACrC"}